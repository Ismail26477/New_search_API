<!DOCTYPE html>
{% load custom_filters %}

<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Website Layout</title>
    <link rel="stylesheet" href="static/style.css"> 
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>

    <!-- Autocomplete script -->
    <script>
        $(document).ready(function() {
            $('#search_query').autocomplete({
                source: function(request, response) {
                    $.ajax({
                        url: '/autocomplete/',
                        dataType: 'json',
                        data: {
                            term: request.term
                        },
                        success: function(data) {
                            response($.map(data, function(item) {
                                return {
                                    label: item,
                                    value: item
                                };
                            }));
                        }
                    });
                },
                minLength: 3,
                select: function(event, ui) {
                    $('#search_query').val(ui.item.value);
                    return false;
                }
            }).data('ui-autocomplete')._renderItem = function(ul, item) {
                var regex = new RegExp('(' + $.ui.autocomplete.escapeRegex(this.term) + ')', 'ig');
                var label = item.label.replace(regex, '<strong>$1</strong>');
                return $('<li>').append('<div>' + label + '</div>').appendTo(ul);
            };
        });
    </script>      
    
</head>
<body>
    <div class="ui-container">
    <!-- Top navigation bar -->
        <div class="topnav">
            <a href="#">Home</a>
            <a href="#">About</a>
            <a href="#">Services</a>
            <a href="#">Contact</a>
        </div>

        <!-- Left sidebar -->
        <div class="left-sidebar">
            <br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br>
        </div>

        <!-- Right sidebar -->
        <div class="right-sidebar">
            <br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br>
        </div>

        <!-- Main content area -->
        <div class="content">
            <div class="faq-box">
            <!-- Search button and output box -->
            <div class="search-box">
                <form class="d-flex" method="get">
                    {% csrf_token %}
                    <input type="text" id="search_query" name="search_query" placeholder="Search...">
                    <button class="btn btn-outline-success" type="submit">Search</button>
                </form>
            </div>
            
            <!-- Output boxes for individual FAQ fields -->
            {% if faqs %}
    <div class="output-box">
        {% for faq in faqs %}
        <div class="faq-box">
            <h3>ID:</h3>
            <p>{{ faq.id }}</p>
            
            <h3>Question:</h3>
            <p>{{ faq.question }}</p>
            
            <h3>Answer:</h3>
            <ul>
                {% for point in faq.answer|split_by_dot %}
                <li>{{ point }}</li>
                {% endfor %}
            </ul> 
            
            <h3>Reference:</h3>
            <p><a href="{{ faq.reference }}">{{ faq.reference }}</a></p>
            
            {% if faq.image %}
                <h3>Image:</h3>
                <img src="{{ faq.image }}" alt="{{ faq.image }}">
            {% endif %}
        </div>
        {% endfor %}
    </div>
{% else %}
    <div class="output-box">
        {% if message %}
            {{ message }}
        {% else %}
            No Answer found
        {% endif %}
    </div>
{% endif %}

        </div>
    </div>
</body>
</html>
